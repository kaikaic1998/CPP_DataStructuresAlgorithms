Master data structures and algorithm